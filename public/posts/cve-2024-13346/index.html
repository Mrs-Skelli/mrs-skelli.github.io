<!doctype html><html><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Cyberpunk nonsense and writeups"><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=/css/custom.css><link rel=icon type=image/x-icon href=/favicon.ico><title>Unauthenticated Arbitrary Shortcode Execution POC - CVE-2024-13346 | Skelli
</title><meta name=theme-color content="#000000"></head><body style=background-color:#000;color:#d8e8ff><div class=mainbg><div class=terminal-window><div class=terminal-header><span class=terminal-title>Unauthenticated Arbitrary Shortcode Execution POC - CVE-2024-13346 ~ warp</span>
<span class=terminal-controls><span class=control></span>
<span class=control></span>
<span class=control></span></span></div><div class=terminal-content><p class=terminal-prompt>skelli@macbook ~ % cd posts</p><p class=terminal-prompt>skelli@macbook ~/posts % cat unauthenticated-arbitrary-shortcode-execution-poc-cve-2024-13346.md</p><div class=content-title><h1>Unauthenticated Arbitrary Shortcode Execution POC - CVE-2024-13346</h1><p class=terminal-date>April 5, 2024</p></div><div class=content><h1 id=unauthenticated-arbitrary-shortcode-execution---cve-2024-13346>Unauthenticated Arbitrary Shortcode Execution - CVE-2024-13346</h1><h2 id=summary>Summary</h2><p>I discovered a vulnerability in a WordPress plugin that allows unauthenticated users to execute arbitrary shortcodes. This can lead to various security issues including XSS, data exposure, and in some configurations, remote code execution.</p><h2 id=timeline>Timeline</h2><ul><li><strong>March 15, 2024</strong>: Vulnerability discovered while pentesting a client&rsquo;s website</li><li><strong>March 18, 2024</strong>: Reported to plugin vendor</li><li><strong>March 25, 2024</strong>: Vendor acknowledged the issue</li><li><strong>April 2, 2024</strong>: Patch released in version 2.5.8</li><li><strong>April 5, 2024</strong>: Public disclosure</li></ul><h2 id=technical-details>Technical Details</h2><p>The vulnerability exists in the way the plugin processes user input from a specific endpoint. The code fails to properly validate input before passing it to WordPress&rsquo;s <code>do_shortcode()</code> function.</p><h3 id=affected-code>Affected Code</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=display:flex><span><span style=color:#75715e>// Vulnerable code in the plugin
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>process_user_input</span>() {
</span></span><span style=display:flex><span>    $user_input <span style=color:#f92672>=</span> <span style=color:#a6e22e>isset</span>($_GET[<span style=color:#e6db74>&#39;param&#39;</span>]) <span style=color:#f92672>?</span> $_GET[<span style=color:#e6db74>&#39;param&#39;</span>] <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>;
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#75715e>// No sanitization or validation!
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>do_shortcode</span>($user_input);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h3 id=proof-of-concept>Proof of Concept</h3><p>The vulnerability can be triggered using a simple GET request:</p><pre tabindex=0><code>https://example.com/wp-admin/admin-ajax.php?action=vulnerable_action&amp;param=[shortcode_to_execute]
</code></pre><p>For example, using the WordPress <code>wp_get_archives</code> shortcode to extract post history:</p><pre tabindex=0><code>https://example.com/wp-admin/admin-ajax.php?action=vulnerable_action&amp;param=[wp_get_archives type=monthly]
</code></pre><h2 id=impact>Impact</h2><p>This vulnerability allows an attacker to:</p><ol><li>Execute any shortcode registered in the WordPress environment</li><li>Potentially access sensitive information depending on installed plugins</li><li>Perform XSS attacks through specially crafted shortcodes</li><li>In some cases, achieve remote code execution if vulnerable shortcodes are installed</li></ol><h2 id=mitigation>Mitigation</h2><p>If you&rsquo;re using the affected plugin:</p><ol><li>Update to version 2.5.8 or newer immediately</li><li>Implement proper Web Application Firewall rules to block suspicious requests</li><li>Consider implementing additional access controls to limit unauthenticated access</li></ol><hr><p><em>This research was conducted following responsible disclosure practices. All examples and details are shared for educational purposes only.</em></p></div><p class=terminal-prompt>skelli@macbook ~/posts % cd ..</p><p class=terminal-prompt>skelli@macbook ~ % ls</p><div class=mt-4><a href=javascript:history.back() class="btn btn-outline-light">← Back</a>
<a href=/ class="btn btn-outline-light">Home</a></div></div></div></div><footer class="footer py-3 mt-5"><div class="container text-center"><span class=text-muted>© 2025 Skelli. All rights reserved.</span></div><script src=/js/script.js></script></footer></body></html>